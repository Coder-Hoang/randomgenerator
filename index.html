<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hoang's Generator</title>
    <style>
        :root {
            --bg: #0a0f1e; --card: #161e2d; --accent: #38bdf8;
            --text: #f1f5f9; --border: #2d3748;
        }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        
        .panel { background: var(--card); padding: 20px; border-radius: 12px; border: 1px solid var(--border); margin-bottom: 30px; }
        textarea { width: 100%; height: 60px; background: #0a0f1e; border: 1px solid var(--border); color: var(--accent); border-radius: 8px; padding: 10px; margin-bottom: 15px; box-sizing: border-box; }
        .controls { display: flex; gap: 10px; }
        select, button { padding: 10px 20px; border-radius: 8px; border: 1px solid var(--border); background: #0a0f1e; color: white; cursor: pointer; }
        button { background: var(--accent); color: #082f49; font-weight: bold; border: none; }

        .teacher-label { text-align: center; color: var(--text-dim); margin: 20px 0 40px; font-weight: bold; letter-spacing: 3px; opacity: 0.5; }

        /* EXACT MAP GRID */
        .classroom-blueprint {
            display: grid;
            grid-template-columns: repeat(4, 180px);
            grid-template-rows: repeat(4, auto);
            gap: 30px 40px;
            justify-content: center;
        }

        .desk { background: var(--card); border: 1px solid var(--border); border-radius: 8px; overflow: hidden; min-height: 80px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.4); }
        .desk-head { background: rgba(56, 189, 248, 0.1); font-size: 11px; padding: 5px; text-align: center; color: var(--accent); border-bottom: 1px solid var(--border); }
        .name { padding: 10px; border-bottom: 1px solid var(--border); font-size: 15px; min-height: 18px; }
        .name:last-child { border: none; }

        .grid-standard { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div class="panel">
        <textarea id="classList">Kayden, OT, Ibaad, Blossom, Jordan, Rhys, Niyat, Hiyab, Rose, Makayla, Faith, Liam, Faris, Danika, Leah, Kiara, Hoang, Yeabsira, Abel, Matthew, Logan, Natan, Semere, Emma, Mac</textarea>
        <div class="controls">
            <select id="mode">
                <option value="desk">Desk</option>
                <option value="single">Single</option>
            </select>
            <button onclick="run()">Generate</button>
        </div>
    </div>

    <div class="teacher-label">MR MALATESTA'S DESK | WHITEBOARD</div>
    <div id="output"></div>
</div>

<script>
    // Initialize dropdown options 2-13
    const sel = document.getElementById('mode');
    for(let i=2; i<=13; i++) {
        let o = document.createElement('option');
        o.value = i; o.innerText = `Groups of ${i}`;
        sel.appendChild(o);
    }

    function run() {
        const input = document.getElementById('classList').value;
        const mode = document.getElementById('mode').value;
        const out = document.getElementById('output');
        out.innerHTML = "";

        // Clean and shuffle students immediately for total fairness
        let students = input.split(/,|\n/).map(s => s.trim()).filter(s => s !== "");
        students = shuffle(students);
        
        if (mode === 'desk') {
            renderFairMap(students, out);
        } else {
            renderNormal(students, out, mode);
        }
    }

    function renderFairMap(students, container) {
        container.className = "classroom-blueprint";
        
        // S = Space, D = Desk
        const layoutPlan = ['S','D','D','S','D','D','D','D','D','D','D','D','D','D','D'];

        layoutPlan.forEach((type) => {
            const slot = document.createElement('div');
            
            if (type === 'D') {
                const seat1 = students.shift() || "";
                const seat2 = students.shift() || "";
                
                if (seat1 || seat2) {
                    slot.className = "desk";
                    slot.innerHTML = `<div class="desk-head">DESK</div>
                                    <div class="name">${seat1}</div>
                                    <div class="name">${seat2}</div>`;
                }
            } else {
                slot.style.visibility = "hidden";
            }
            container.appendChild(slot);
        });
    }

    function renderNormal(students, container, mode) {
        container.className = "grid-standard";
        let size = mode === 'single' ? 1 : parseInt(mode);
        for (let i = 0; i < students.length; i += size) {
            const group = students.slice(i, i + size);
            const div = document.createElement('div');
            div.className = "desk";
            div.innerHTML = `<div class="desk-head">GROUP ${Math.floor(i/size)+1}</div>` + 
                            group.map(n => `<div class="name">${n}</div>`).join('');
            container.appendChild(div);
        }
    }

    function shuffle(arr) {
        let currentIndex = arr.length;
        while (currentIndex != 0) {
            let randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [arr[currentIndex], arr[randomIndex]] = [arr[randomIndex], arr[currentIndex]];
        }
        return arr;
    }
</script>
</body>
</html>
